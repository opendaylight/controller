{
  "comments": [
    {
      "key": {
        "uuid": "fa82b9bf_8df21405",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 54,
      "author": {
        "id": 1842
      },
      "writtenOn": "2014-09-10T17:18:42Z",
      "side": 1,
      "message": "I think we need to check closed flag here and send the close message. Also this method should be synchronized with the close method to be complete, then closed doesn\u0027t really need to be volatile. Ie:\n\nboolean sendCloseMessage \u003d false;\nsynchronized(this) {\n    if(closed) {\n        sendCloseMessage \u003d true;\n    } else {\n        this.listenerRegistrationActor \u003d listenerRegistrationActor;\n    }\n}\n\nif(sendCloseMessage) {\n    listenerRegistrationActor.tell(new   \n                CloseDataChangeListenerRegistration().toSerializable(), null);\n}",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa82b9bf_6de31006",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 54,
      "author": {
        "id": 795
      },
      "writtenOn": "2014-09-10T17:47:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fa82b9bf_8df21405",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa82b9bf_0dbda402",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1842
      },
      "writtenOn": "2014-09-10T17:18:42Z",
      "side": 1,
      "message": "Synchronize with setListenerRegistrationActor, i.e.:\n\nboolean sendCloseMessage;\nsynchronized(this) {\n    sendCloseMessage \u003d !closed \u0026\u0026 listenerRegistrationActor !\u003d null;\n    closed \u003d true;\n}\n\nif(sendCloseMessage) {\n    listenerRegistrationActor.tell(new   \n                CloseDataChangeListenerRegistration().toSerializable(), null);\n}",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa82b9bf_0df044c8",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 795
      },
      "writtenOn": "2014-09-10T17:47:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fa82b9bf_0dbda402",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa82b9bf_2dc4285e",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 807
      },
      "writtenOn": "2014-09-10T17:51:56Z",
      "side": 1,
      "message": "Do you think it would be better to use AtomicBoolean? Then we wont need to synchronized. \nIts a minor thing and I wont block the commit for it.",
      "parentUuid": "fa82b9bf_0dbda402",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa82b9bf_ad391843",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 795
      },
      "writtenOn": "2014-09-11T04:57:38Z",
      "side": 1,
      "message": "https://bugs.opendaylight.org/show_bug.cgi?id\u003d1795",
      "parentUuid": "fa82b9bf_2dc4285e",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa82b9bf_2dd748ef",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/DataChangeListenerRegistrationProxy.java",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1842
      },
      "writtenOn": "2014-09-11T10:49:26Z",
      "side": 1,
      "message": "We have 2 variables in play here, closed and listenerRegistrationActor. The sync block is needed for atomicity to guarantee we only send one close message to the actor. I don\u0027t think we would be able to do that with just an AtomicBoolean and CAS.",
      "parentUuid": "fa82b9bf_2dc4285e",
      "revId": "6e743f5afe088d9116d161f34655cf1bb28bc1d9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}