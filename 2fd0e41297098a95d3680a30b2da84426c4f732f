{
  "comments": [
    {
      "key": {
        "uuid": "1a76adc5_af05697b",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/RaftActor.java",
        "patchSetId": 2
      },
      "lineNbr": 181,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-09T23:30:47Z",
      "side": 1,
      "message": "Please prefix log messages with persistenceId(), i.e.\n   \n     LOG.debug(\"{}: ...\", persistenceId());",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_354c4842",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/RaftActor.java",
        "patchSetId": 2
      },
      "lineNbr": 181,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-11T17:20:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1a76adc5_af05697b",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_f0201ef9",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 596,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-12T12:17:21Z",
      "side": 1,
      "message": "This test is specific for another purpose so we shouldn\u0027t be overloading it to test snapshot on recovery. The same with the other tests below that you modified. Please add a specific test for snapshot on recovery. \n\nAlso adding to the log to force a snapshot as you\u0027re doing above will be prone to intermittent test failures. Recovery is done async so it may already be complete by the time line 594 executes. The safest way to test this is to add an entry to the InMemoryJournal before creating the actor- there\u0027s tests that do that.",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_444037a5",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 596,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-12T17:33:32Z",
      "side": 1,
      "message": "So far in multiple UT runs have not run into intermittent test failures. Anyways see a point here; so will try what you said \u0026 comeback - esp the InMemoryJournal entry addition \u0026 test.",
      "parentUuid": "1a76adc5_f0201ef9",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fad0f9df_12ddec42",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 596,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-14T20:41:01Z",
      "side": 1,
      "message": "I have a script that loops over a unit test over and over and quits if it fails. Unit tests with akka and actors are often tricky due to the async nature. I\u0027ve seen unit tests succeed dozens of times even over 100 times before failing. Sometimes a unit test runs fine in jenkins for weeks or months before failing (in fact I just had one today). I haven\u0027t run this test with the script but it looks like it will be prone to intermittent timing failures.",
      "parentUuid": "1a76adc5_444037a5",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fad0f9df_9548e6cd",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 596,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-15T11:38:06Z",
      "side": 1,
      "message": "Sure Tom. I have started working on this \u0026 getting the OnRecoveryCaptureSnapshot JUnit test script passed consistently. If you can share your looping script will try with that too.",
      "parentUuid": "fad0f9df_12ddec42",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fad0f9df_1155cd1c",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 596,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-26T15:25:37Z",
      "side": 1,
      "message": "new JUnit test case added for OnRecoverySnapshot based on InMemoryJournal before creating the actor",
      "parentUuid": "1a76adc5_f0201ef9",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fad0f9df_b1188185",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 596,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-26T15:25:37Z",
      "side": 1,
      "message": "new JUnit test case added for OnRecoverySnapshot based on InMemoryJournal before creating the actor \u0026 loop test run for 10+ times until now successfully",
      "parentUuid": "fad0f9df_9548e6cd",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_6fff5168",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 1036,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-09T23:30:47Z",
      "side": 1,
      "message": "There\u0027s a simpler way to verify that snapshot capture was initiated. Mockito.verify also takes a timeout() param that waits for the method to be called. I think it\u0027s sufficient to only verify that snapshot capture was initiated so you just need to do:\n\n    verify(actor.snapshotCohortDelegate, timeout(5000))\n            .createSnapshot(any(ActorRef.class));\n\nWe have other tests for full snapshot verification.",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_d562b4ac",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 1036,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-11T17:20:36Z",
      "side": 1,
      "message": "Tom, In this function refactored from base code, intent is to handle the additional snapshot triggered on recovery (with this 3381 fix) other than the snapshot triggered by the existing testFake.* functions. Hence retaining this change to avoid test failures in this new scenario",
      "parentUuid": "1a76adc5_6fff5168",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_90ec4a91",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 1036,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-12T12:17:21Z",
      "side": 1,
      "message": "Th reason you had test failures was b/c you were always triggering snapshot, even with an empty journal. Now that you\u0027ve changed that, those testFake.* methods should work w/o change as they start with an empty journal.\n\nWhat I was referring to above is the code in this method. It looks like the purpose is to verify that a snapshot was initiated. What I meant was, instead of the busy wait above and the other code, you could simply verify createSnapshot was called with a timeout as I outlined in my previous comment. So that 1 line of code would be sufficient to verify.",
      "parentUuid": "1a76adc5_d562b4ac",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_a4390b43",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 1036,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-12T17:33:32Z",
      "side": 1,
      "message": "Let me try this \u0026 comeback Tom",
      "parentUuid": "1a76adc5_90ec4a91",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fad0f9df_71121964",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/test/java/org/opendaylight/controller/cluster/raft/RaftActorTest.java",
        "patchSetId": 2
      },
      "lineNbr": 1036,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-26T15:25:37Z",
      "side": 1,
      "message": "test simplified to just check if captureSnapshot was triggered using verify on timeout API",
      "parentUuid": "1a76adc5_a4390b43",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_2ff95980",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2347,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-09T23:30:47Z",
      "side": 1,
      "message": "Code below is indented too much.",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_5547841d",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2347,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-11T17:20:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1a76adc5_2ff95980",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_4ff4d586",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2350,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-09T23:30:47Z",
      "side": 1,
      "message": "Don\u0027t need System.out.",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_f55570c6",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2350,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-11T17:20:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1a76adc5_4ff4d586",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_8f02ed6d",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2367,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-09T23:30:47Z",
      "side": 1,
      "message": "\u0027r\u0027 looks misplaced",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_15510cd8",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2367,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-11T17:20:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1a76adc5_8f02ed6d",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_eff28199",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2368,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-10-09T23:30:47Z",
      "side": 1,
      "message": "It doesn\u0027t seem like these changes were needed but it\u0027s fine (unless I\u0027m missing something).",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a76adc5_b55ff8e4",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/test/java/org/opendaylight/controller/cluster/datastore/ShardTest.java",
        "patchSetId": 2
      },
      "lineNbr": 2368,
      "author": {
        "id": 2981
      },
      "writtenOn": "2015-10-11T17:20:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1a76adc5_eff28199",
      "revId": "2fd0e41297098a95d3680a30b2da84426c4f732f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}