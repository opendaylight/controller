{
  "comments": [
    {
      "key": {
        "uuid": "7a96c907_b05fd940",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T05:09:51Z",
      "side": 1,
      "message": "Could you please add the bug id to this message",
      "range": {
        "startLine": 7,
        "startChar": 6,
        "endLine": 7,
        "endChar": 7
      },
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_70307101",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T05:09:51Z",
      "side": 1,
      "message": "AppendEntriesReply is not being handled here. It should be because this is where the replies will end up. Or am I missing something?\n\nFrom the Follower code AppendEntriesReply is sent to the sender.",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_6b2162fa",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-03T06:21:31Z",
      "side": 1,
      "message": "It uses the leader actor as the sender so AppendEntriesReply should go to the leader.",
      "parentUuid": "7a96c907_70307101",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_666d1798",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T09:46:02Z",
      "side": 1,
      "message": "Oops right. So, this is not a problem ignore Harman.",
      "parentUuid": "7a96c907_6b2162fa",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_cb0f562d",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 96,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T05:09:51Z",
      "side": 1,
      "message": "Based on the EntriesPackageActor code we cannot hit the !empty condition because if it was not empty it would have sent a serialized message.",
      "range": {
        "startLine": 96,
        "startChar": 33,
        "endLine": 96,
        "endChar": 40
      },
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_da13a664",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-01T04:46:09Z",
      "side": 1,
      "message": "Do we need to look this up every time (looks potentially expensive)?",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_90d73ded",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1903
      },
      "writtenOn": "2015-02-02T23:51:56Z",
      "side": 1,
      "message": "This was done to handle scenario if actorselection is there, but not actorreference. which i am not really sure. Look at comment in AbstractLeader.java",
      "parentUuid": "7a96c907_da13a664",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_702151fa",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-03T03:06:20Z",
      "side": 1,
      "message": "Which comment? I guess I don\u0027t understand why getSingleActorRefFromSelector is necessary. It\u0027s only used to decide whether to schedule the heartbeat but handleReceive accesses followerActor regardless. Also if  followerActorRef.isPresent was false the first time, the heartbeat would never be scheduled on subsequent calls because heartbeatPayload would be non-null.",
      "parentUuid": "7a96c907_90d73ded",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_3a1dea73",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-01T04:46:09Z",
      "side": 1,
      "message": "This is scheduled once on the first AppendEntries sent so that instance will be sent in every heartbeat. If the index data is updated in a subsequent AppendEntries it won\u0027t get picked up here. How about using the SendHeartbeat message here?",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_5009b593",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1903
      },
      "writtenOn": "2015-02-02T23:51:56Z",
      "side": 1,
      "message": "yes, you are right, i was under the impression that if i change the object in reference, scheduler will automatically pick the new object, but that is not the case. I am canceling and restarting the scheduler, if appendEntry message with updated data comes in.",
      "parentUuid": "7a96c907_3a1dea73",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_1011edab",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/HeartbeatActor.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-03T03:06:20Z",
      "side": 1,
      "message": "I think it would be easier to use the SendHeartbeat message here. Then in handleReceive, on SendHeartbeat, send heartbeatPayload to the followerActor. This would be more efficient than stopping/starting the schedule  as it could happen a lot.",
      "parentUuid": "7a96c907_5009b593",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_4b2b4682",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T05:09:51Z",
      "side": 1,
      "message": "Harman you seem to have undone some optimizations that Robert had put in place with an earlier patch. The followers set needs to go. See https://git.opendaylight.org/gerrit/#/c/14445/",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_da3c06e5",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-01T04:17:35Z",
      "side": 1,
      "message": "Please make these private with accessors, if needed.",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_7a2b7294",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 291,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-01T04:46:09Z",
      "side": 1,
      "message": "It does\u0027t look like we need this anymore.",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_8b194e7b",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 291,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T05:09:51Z",
      "side": 1,
      "message": "We still need this because we use the heartbeat for replication as well. For lagging followers on a timeout we do need to decide if some data needs to be sent to each follower.",
      "parentUuid": "7a96c907_7a2b7294",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_4bcca635",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 291,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-03T06:21:31Z",
      "side": 1,
      "message": "I should re-phrase - I agree we need it but it\u0027s no longer being sent with these changes. Previously, it was only sent by the heartbeat timing but that was removed from this class.",
      "parentUuid": "7a96c907_8b194e7b",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_fa3f82d4",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 340,
      "author": {
        "id": 1842
      },
      "writtenOn": "2015-02-01T04:17:35Z",
      "side": 1,
      "message": "Is it safe to capture this once? I think this is dynamic - other code looks it up when needed. Also, I\u0027ve seen this return null.",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_70dcf112",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 340,
      "author": {
        "id": 1903
      },
      "writtenOn": "2015-02-02T23:51:56Z",
      "side": 1,
      "message": "hmm, I am not sure, I thought ActorSelection will always be there even if ActorReference is not present, that is why I am checking ActorReference before scheduling the heartbeat. So, Other possibility could be create these supporting actors only for those followers, whose ActorReference is getting resolved at this time. Create other follower\u0027s supporting actor dynamically, when they join cluster.",
      "parentUuid": "7a96c907_fa3f82d4",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96c907_2b283a85",
        "filename": "opendaylight/md-sal/sal-akka-raft/src/main/java/org/opendaylight/controller/cluster/raft/behaviors/AbstractLeader.java",
        "patchSetId": 1
      },
      "lineNbr": 340,
      "author": {
        "id": 795
      },
      "writtenOn": "2015-02-03T05:09:51Z",
      "side": 1,
      "message": "It\u0027s true that we always construct an ActorSelection for the peer dynamically but as Harman pointed out we should not need to. Maybe we can optimize getPeerActorSelection to cache the selection.",
      "parentUuid": "7a96c907_70dcf112",
      "revId": "6d5b03344abc49b8ed3f4c81a1534a2403b8e66b",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}