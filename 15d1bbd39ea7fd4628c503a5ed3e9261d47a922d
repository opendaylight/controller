{
  "comments": [
    {
      "key": {
        "uuid": "1a622d24_05c00729",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/ShardDataTree.java",
        "patchSetId": 2
      },
      "lineNbr": 766,
      "author": {
        "id": 6757
      },
      "writtenOn": "2016-12-21T07:57:02Z",
      "side": 1,
      "message": "when the method replicate() is called in AbstractLeader, the logIndex will be out of sequence if the applyModificationToState flag return true",
      "range": {
        "startLine": 766,
        "startChar": 8,
        "endLine": 766,
        "endChar": 40
      },
      "revId": "15d1bbd39ea7fd4628c503a5ed3e9261d47a922d",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a622d24_6083a956",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/ShardDataTree.java",
        "patchSetId": 2
      },
      "lineNbr": 766,
      "author": {
        "id": 1842
      },
      "writtenOn": "2016-12-21T10:30:53Z",
      "side": 1,
      "message": "Not sure I follow - can you elaborate? As per my comment above, \"if the next pending transaction is progressed to COMMIT_PENDING and this method (startCommit) is called, the next transaction will not attempt to replicate b/c the current transaction is still at the head of the pendingCommits queue.\". Even if it did, logIndex is obtained from the passed ReplicatedLogEntry which is newly allocated in persistData and this call chain hasn\u0027t progressed to persistData yet so what could the logIndex be out of sequence with?",
      "parentUuid": "1a622d24_05c00729",
      "range": {
        "startLine": 766,
        "startChar": 8,
        "endLine": 766,
        "endChar": 40
      },
      "revId": "15d1bbd39ea7fd4628c503a5ed3e9261d47a922d",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a622d24_22c9b426",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/ShardDataTree.java",
        "patchSetId": 2
      },
      "lineNbr": 766,
      "author": {
        "id": 6757
      },
      "writtenOn": "2016-12-22T02:37:33Z",
      "side": 1,
      "message": "It seem to be a recursive processing. I misunderstand the order of the method shard.persistPayload() is called. On second thought, the applyLogToStateMachine(logindex) sequence will be correct. but I\u0027m still puzzled about the order of shard.persistPayload(), for example, if the current Tx is Tx-N, {Tx-N+1, Tx-N+2} in pendingTransactions queue. first Tx-N+2.shard.persistPayload(replicationBatchHint\u003dfalse) with logindex(M)\nand then  Tx-N+1.shard.persistPayload(replicationBatchHint\u003dfalse) with logindex(M+1)\nfinally,  Tx-N.shard.persistPayload(replicationBatchHint\u003dtrue) with logindex(M+2)\n\nis it right ?",
      "parentUuid": "1a622d24_6083a956",
      "range": {
        "startLine": 766,
        "startChar": 8,
        "endLine": 766,
        "endChar": 40
      },
      "revId": "15d1bbd39ea7fd4628c503a5ed3e9261d47a922d",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a622d24_a22664cc",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/ShardDataTree.java",
        "patchSetId": 2
      },
      "lineNbr": 766,
      "author": {
        "id": 1842
      },
      "writtenOn": "2016-12-22T04:02:32Z",
      "side": 1,
      "message": "No. If 3 txs are queued with CAN_COMMIT_PENDING and immediately progress to COMMIT_PENDING,  replicationBatchHint will be passed as true, true, false. Take a look at ShardDataTreeTest#testPipelinedTransactionsWithImmediateCommits - it plays out this scenario.",
      "parentUuid": "1a622d24_22c9b426",
      "range": {
        "startLine": 766,
        "startChar": 8,
        "endLine": 766,
        "endChar": 40
      },
      "revId": "15d1bbd39ea7fd4628c503a5ed3e9261d47a922d",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a622d24_25d25e5c",
        "filename": "opendaylight/md-sal/sal-distributed-datastore/src/main/java/org/opendaylight/controller/cluster/datastore/ShardDataTree.java",
        "patchSetId": 2
      },
      "lineNbr": 766,
      "author": {
        "id": 6757
      },
      "writtenOn": "2016-12-22T06:28:32Z",
      "side": 1,
      "message": "Sorry, It\u0027s a clerical error about the replicationBatchHint description. I totally understand it, thanks for you elaboration",
      "parentUuid": "1a622d24_a22664cc",
      "range": {
        "startLine": 766,
        "startChar": 8,
        "endLine": 766,
        "endChar": 40
      },
      "revId": "15d1bbd39ea7fd4628c503a5ed3e9261d47a922d",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}